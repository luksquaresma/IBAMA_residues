{
  "name" : "IBAMA_RESIDUOS",
  "description" : "",
  "role" : "arn:aws:iam::280755897748:role/ETL_ELT",
  "executionProperty" : {
    "maxConcurrentRuns" : 1
  },
  "command" : {
    "name" : "glueetl",
    "scriptLocation" : "s3://aws-glue-assets-280755897748-sa-east-1/scripts/IBAMA_RESIDUOS.py",
    "pythonVersion" : "3"
  },
  "defaultArguments" : {
    "--enable-spark-ui" : "true",
    "--extra-py-files" : "s3://aws-glue-studio-transforms-881619130292-prod-sa-east-1/gs_common.py,s3://aws-glue-studio-transforms-881619130292-prod-sa-east-1/gs_derived.py",
    "--spark-event-logs-path" : "s3://jm2vtech/pos/residuos_solidos_ibama/pipeline/glue/tmp/spark_ui/",
    "--enable-job-insights" : "false",
    "--enable-glue-datacatalog" : "true",
    "--enable-continuous-cloudwatch-log" : "true",
    "--job-bookmark-option" : "job-bookmark-disable",
    "--job-language" : "python",
    "--TempDir" : "s3://jm2vtech/pos/residuos_solidos_ibama/pipeline/glue/tmp/tmp/",
    "--enable-auto-scaling" : "true"
  },
  "maxRetries" : 0,
  "allocatedCapacity" : 10,
  "timeout" : 2880,
  "maxCapacity" : 10.0,
  "glueVersion" : "4.0",
  "numberOfWorkers" : 10,
  "workerType" : "G.1X",
  "executionClass" : "FLEX",
  "codeGenConfigurationNodes" : "{\"node-1704582297850\":{\"S3GlueParquetTarget\":{\"Compression\":\"uncompressed\",\"Inputs\":[\"node-1704578935239\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://jm2vtech/pos/residuos_solidos_ibama/pipeline/glue/catalog/destinador/\",\"SchemaChangePolicy\":{\"Database\":\"ibama_residuos\",\"EnableUpdateCatalog\":true,\"Table\":\"destinador\",\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"}}},\"node-1704578935239\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1704578845454\"],\"Name\":\"Derived Column\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"estado\",\"Type\":\"string\"},{\"Name\":\"razaoSocialDestinador\",\"Type\":\"string\"},{\"Name\":\"detalhe\",\"Type\":\"string\"},{\"Name\":\"situacaoCadastral\",\"Type\":\"string\"},{\"Name\":\"municipio\",\"Type\":\"string\"},{\"Name\":\"codigoDetalhe\",\"Type\":\"double\"},{\"Name\":\"codigoCategoria\",\"Type\":\"double\"},{\"Name\":\"tipoDestinacao\",\"Type\":\"string\"},{\"Name\":\"unidade\",\"Type\":\"string\"},{\"Name\":\"cnpjGeradorResiduo\",\"Type\":\"string\"},{\"Name\":\"anoDestinacao\",\"Type\":\"bigint\"},{\"Name\":\"cnpjDestinador\",\"Type\":\"string\"},{\"Name\":\"quantdestinada\",\"Type\":\"double\"},{\"Name\":\"categoriaAtividade\",\"Type\":\"string\"},{\"Name\":\"razaoSocialGeradorResiduo\",\"Type\":\"string\"},{\"Name\":\"codResiduo\",\"Type\":\"bigint\"},{\"Name\":\"descResiduo\",\"Type\":\"string\"},{\"Name\":\"__index_level_0__\",\"Type\":\"bigint\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"quantdestinada\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"cast(regexp_replace(regexp_replace(quantdestinada, '[.]', ''), ',', '.') as double) as quantdestinada\"]}],\"Path\":\"s3://aws-glue-studio-transforms-881619130292-prod-sa-east-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1704582329870\":{\"S3GlueParquetTarget\":{\"Compression\":\"uncompressed\",\"Inputs\":[\"node-1704579002026\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://jm2vtech/pos/residuos_solidos_ibama/pipeline/glue/catalog/destinador_unpack/\",\"SchemaChangePolicy\":{\"Database\":\"ibama_residuos\",\"EnableUpdateCatalog\":true,\"Table\":\"destinador_unpack\",\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"}}},\"node-1704574782898\":{\"SparkSQL\":{\"Inputs\":[\"node-1704576533174\"],\"Name\":\"SQL Query\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"word\",\"Type\":\"string\"},{\"Name\":\"anogeracao\",\"Type\":\"bigint\"},{\"Name\":\"tipo\",\"Type\":\"string\"},{\"Name\":\"detalhe\",\"Type\":\"double\"},{\"Name\":\"tiporesiduo\",\"Type\":\"double\"},{\"Name\":\"categoriaatividade\",\"Type\":\"double\"},{\"Name\":\"razaosocialgerador\",\"Type\":\"double\"}]}],\"SqlAliases\":[{\"Alias\":\"myDataSource\",\"From\":\"node-1704576533174\"}],\"SqlQuery\":\"WITH \\n\\nsplited AS (\\n    SELECT \\n\\n    quantidadegerada, --cast(regexp_replace(regexp_replace(quantidadegerada, '[.]', ''), ',', '.') as double) as quantidadegerada,\\n    anogeracao,\\n    CASE \\n        WHEN unidade=\\\"Litro\\\"      AND classificacaoresiduo=\\\"Perigoso\\\"       THEN 'Líquido Perigoso'\\n        WHEN unidade=\\\"Litro\\\"      AND classificacaoresiduo=\\\"Não Perigoso\\\"   THEN 'Líquido Não Perigoso'\\n        WHEN unidade=\\\"kilogramas\\\" AND classificacaoresiduo=\\\"Perigoso\\\"       THEN 'Sólido Perigoso'\\n        WHEN unidade=\\\"kilogramas\\\" AND classificacaoresiduo=\\\"Não Perigoso\\\"   THEN 'Sólido Não Perigoso'\\n        WHEN unidade=\\\"Unidade\\\" AND classificacaoresiduo=\\\"Perigoso\\\"       THEN 'Outro Perigoso'\\n        WHEN unidade=\\\"Unidade\\\" AND classificacaoresiduo=\\\"Não Perigoso\\\"   THEN 'Outro Não Perigoso'\\n        ELSE 'Outro'\\n    END AS tipo,\\n    split(lower(regexp_replace(regexp_replace(tiporesiduo, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as tiporesiduo,\\n    split(lower(regexp_replace(regexp_replace(detalhe, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as detalhe,\\n    split(lower(regexp_replace(regexp_replace(categoriaatividade, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as categoriaatividade,\\n    split(lower(regexp_replace(regexp_replace(razaosocialgerador, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as razaosocialgerador\\n\\n    FROM myDataSource\\n),\\n\\nexp_detalhe AS (\\n    SELECT \\n        word,\\n        anogeracao,\\n        tipo,\\n        SUM(COALESCE(CAST(detalhe AS FLOAT), 0)) AS detalhe\\n    FROM \\n    (\\n        SELECT \\n            explode(detalhe) AS word,\\n            anogeracao,\\n            tipo,\\n            CASE \\n                WHEN quantidadegerada IS NULL OR quantidadegerada = '' THEN '0'\\n                ELSE quantidadegerada\\n            END AS detalhe\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anogeracao, tipo\\n    ORDER BY word DESC\\n),\\n\\nexp_tiporesiduo AS (\\n    SELECT \\n        word,\\n        anogeracao,\\n        tipo,\\n        SUM(COALESCE(CAST(tiporesiduo AS FLOAT), 0)) AS tiporesiduo\\n    FROM \\n    (\\n        SELECT \\n            explode(tiporesiduo) AS word,\\n            anogeracao,\\n            tipo,\\n            CASE \\n                WHEN quantidadegerada IS NULL OR quantidadegerada = '' THEN '0'\\n                ELSE quantidadegerada\\n            END AS tiporesiduo\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anogeracao, tipo\\n    ORDER BY word DESC\\n),\\n\\nexp_categoriaatividade AS (\\n    SELECT \\n        word,\\n        anogeracao,\\n        tipo,\\n        SUM(COALESCE(CAST(categoriaatividade AS FLOAT), 0)) AS categoriaatividade\\n    FROM \\n    (\\n        SELECT \\n            explode(categoriaatividade) AS word,\\n            anogeracao,\\n            tipo,\\n            CASE \\n                WHEN quantidadegerada IS NULL OR quantidadegerada = '' THEN '0'\\n                ELSE quantidadegerada\\n            END AS categoriaatividade\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anogeracao, tipo\\n    ORDER BY word DESC\\n),\\n\\nexp_razaosocialgerador AS (\\n    SELECT \\n        word,\\n        anogeracao,\\n        tipo,\\n        SUM(COALESCE(CAST(razaosocialgerador AS FLOAT), 0)) AS razaosocialgerador\\n    FROM \\n    (\\n        SELECT \\n            explode(razaosocialgerador) AS word,\\n            anogeracao,\\n            tipo,\\n            CASE \\n                WHEN quantidadegerada IS NULL OR quantidadegerada = '' THEN '0'\\n                ELSE quantidadegerada\\n            END AS razaosocialgerador\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anogeracao, tipo\\n    ORDER BY word DESC\\n)\\n\\nSELECT \\n    COALESCE(\\n        exp_detalhe.word, \\n        exp_tiporesiduo.word, \\n        exp_categoriaatividade.word, \\n        exp_razaosocialgerador.word\\n        ) AS word,\\n    COALESCE(\\n        exp_detalhe.anogeracao, \\n        exp_tiporesiduo.anogeracao, \\n        exp_categoriaatividade.anogeracao, \\n        exp_razaosocialgerador.anogeracao\\n        ) AS anogeracao,\\n    COALESCE(\\n        exp_detalhe.tipo, \\n        exp_tiporesiduo.tipo, \\n        exp_categoriaatividade.tipo, \\n        exp_razaosocialgerador.tipo\\n        ) AS tipo,  \\n    COALESCE(detalhe, 0) AS detalhe,\\n    COALESCE(tiporesiduo, 0) AS tiporesiduo,\\n    COALESCE(categoriaatividade, 0) AS categoriaatividade,\\n    COALESCE(razaosocialgerador, 0) AS razaosocialgerador\\n\\nFROM exp_detalhe \\nFULL OUTER JOIN exp_tiporesiduo \\nON exp_detalhe.word = exp_tiporesiduo.word \\nAND exp_detalhe.anogeracao = exp_tiporesiduo.anogeracao\\nAND exp_detalhe.tipo = exp_tiporesiduo.tipo\\n\\nFULL OUTER JOIN exp_categoriaatividade \\nON COALESCE(exp_detalhe.word, exp_tiporesiduo.word) = exp_categoriaatividade.word\\nAND COALESCE(exp_detalhe.anogeracao, exp_tiporesiduo.anogeracao) = exp_categoriaatividade.anogeracao\\nAND COALESCE(exp_detalhe.tipo, exp_tiporesiduo.tipo) = exp_categoriaatividade.tipo\\n\\nFULL OUTER JOIN exp_razaosocialgerador \\nON COALESCE(exp_detalhe.word, exp_tiporesiduo.word, exp_categoriaatividade.word) = exp_razaosocialgerador.word\\nAND COALESCE(exp_detalhe.anogeracao, exp_tiporesiduo.anogeracao, exp_categoriaatividade.anogeracao) = exp_razaosocialgerador.anogeracao\\nAND COALESCE(exp_detalhe.tipo, exp_tiporesiduo.tipo, exp_categoriaatividade.tipo) = exp_razaosocialgerador.tipo\\n\\n;\"}},\"node-1704576533174\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1704574745062\"],\"Name\":\"Derived Column\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"cnpjGerador\",\"Type\":\"string\"},{\"Name\":\"estado\",\"Type\":\"string\"},{\"Name\":\"detalhe\",\"Type\":\"string\"},{\"Name\":\"situacaoCadastral\",\"Type\":\"string\"},{\"Name\":\"municipio\",\"Type\":\"string\"},{\"Name\":\"codigoDetalhe\",\"Type\":\"bigint\"},{\"Name\":\"anoGeracao\",\"Type\":\"bigint\"},{\"Name\":\"codigoCategoria\",\"Type\":\"bigint\"},{\"Name\":\"unidade\",\"Type\":\"string\"},{\"Name\":\"classificacaoResiduo\",\"Type\":\"string\"},{\"Name\":\"quantidadegerada\",\"Type\":\"double\"},{\"Name\":\"tipoResiduo\",\"Type\":\"string\"},{\"Name\":\"categoriaAtividade\",\"Type\":\"string\"},{\"Name\":\"razaoSocialGerador\",\"Type\":\"string\"},{\"Name\":\"codResiduo\",\"Type\":\"bigint\"},{\"Name\":\"__index_level_0__\",\"Type\":\"bigint\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"quantidadegerada\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"cast(regexp_replace(regexp_replace(quantidadegerada, '[.]', ''), ',', '.') as double) as quantidadegerada\"]}],\"Path\":\"s3://aws-glue-studio-transforms-881619130292-prod-sa-east-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1704576833854\":{\"DynamicTransform\":{\"FunctionName\":\"gs_derived\",\"Inputs\":[\"node-1704574989215\"],\"Name\":\"Derived Column\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"RazSocEmpresaArmazDest\",\"Type\":\"string\"},{\"Name\":\"estado\",\"Type\":\"string\"},{\"Name\":\"situacao\",\"Type\":\"string\"},{\"Name\":\"razaoSocialEmpGeradoraResiduo\",\"Type\":\"string\"},{\"Name\":\"cnpjArmazenamentoDestinacao\",\"Type\":\"string\"},{\"Name\":\"situacaoCadastral\",\"Type\":\"string\"},{\"Name\":\"municipio\",\"Type\":\"string\"},{\"Name\":\"razaoSocialArmazenador\",\"Type\":\"string\"},{\"Name\":\"unidade\",\"Type\":\"string\"},{\"Name\":\"numCnpjEmpGeradoraResiduo\",\"Type\":\"string\"},{\"Name\":\"qtdarmazenviadadestfinal\",\"Type\":\"double\"},{\"Name\":\"DescResiduo\",\"Type\":\"string\"},{\"Name\":\"cnpjArmazenador\",\"Type\":\"string\"},{\"Name\":\"anoDestinacao\",\"Type\":\"bigint\"},{\"Name\":\"tipoArmazenamentoDestin\",\"Type\":\"string\"},{\"Name\":\"codResiduo\",\"Type\":\"bigint\"},{\"Name\":\"__index_level_0__\",\"Type\":\"bigint\"}]}],\"Parameters\":[{\"IsOptional\":false,\"Name\":\"colName\",\"Type\":\"str\",\"Value\":[\"qtdarmazenviadadestfinal\"]},{\"IsOptional\":false,\"Name\":\"expr\",\"Type\":\"str\",\"Value\":[\"cast(regexp_replace(regexp_replace(qtdarmazenviadadestfinal, '[.]', ''), ',', '.') as double) as qtdarmazenviadadestfinal\"]}],\"Path\":\"s3://aws-glue-studio-transforms-881619130292-prod-sa-east-1/gs_derived.py\",\"TransformName\":\"gs_derived\",\"Version\":\"1.0.0\"}},\"node-1704582583655\":{\"S3GlueParquetTarget\":{\"Compression\":\"uncompressed\",\"Inputs\":[\"node-1704576951442\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://jm2vtech/pos/residuos_solidos_ibama/pipeline/glue/catalog/armazenador_unpack/\",\"SchemaChangePolicy\":{\"Database\":\"ibama_residuos\",\"EnableUpdateCatalog\":true,\"Table\":\"armazenador_unpack\",\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"}}},\"node-1704578845454\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://jm2vtech/pos/residuos_solidos_ibama/src/compressed/destinador_residuo_solido.parquet\"},\"Exclusions\":[],\"Name\":\"Destinador\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"estado\",\"Type\":\"string\"},{\"Name\":\"razaosocialdestinador\",\"Type\":\"string\"},{\"Name\":\"detalhe\",\"Type\":\"string\"},{\"Name\":\"situacaocadastral\",\"Type\":\"string\"},{\"Name\":\"municipio\",\"Type\":\"string\"},{\"Name\":\"codigodetalhe\",\"Type\":\"double\"},{\"Name\":\"codigocategoria\",\"Type\":\"double\"},{\"Name\":\"tipodestinacao\",\"Type\":\"string\"},{\"Name\":\"unidade\",\"Type\":\"string\"},{\"Name\":\"cnpjgeradorresiduo\",\"Type\":\"string\"},{\"Name\":\"anodestinacao\",\"Type\":\"bigint\"},{\"Name\":\"cnpjdestinador\",\"Type\":\"string\"},{\"Name\":\"quantdestinada\",\"Type\":\"string\"},{\"Name\":\"categoriaatividade\",\"Type\":\"string\"},{\"Name\":\"razaosocialgeradorresiduo\",\"Type\":\"string\"},{\"Name\":\"codresiduo\",\"Type\":\"bigint\"},{\"Name\":\"descresiduo\",\"Type\":\"string\"},{\"Name\":\"__index_level_0__\",\"Type\":\"bigint\"}]}],\"Paths\":[\"s3://jm2vtech/pos/residuos_solidos_ibama/src/compressed/destinador_residuo_solido.parquet\"],\"Recurse\":true}},\"node-1704578550767\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://jm2vtech/pos/residuos_solidos_ibama/src/compressed/transportador_residuo_solido.parquet\"},\"Exclusions\":[],\"Name\":\"Transportador\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"estado\",\"Type\":\"string\"},{\"Name\":\"ano\",\"Type\":\"bigint\"},{\"Name\":\"cnpjorigem\",\"Type\":\"string\"},{\"Name\":\"situacaocadastral\",\"Type\":\"string\"},{\"Name\":\"razaosocialtransportador\",\"Type\":\"string\"},{\"Name\":\"municipio\",\"Type\":\"string\"},{\"Name\":\"razaosocialorigem\",\"Type\":\"string\"},{\"Name\":\"cnpjtransportador\",\"Type\":\"string\"},{\"Name\":\"__index_level_0__\",\"Type\":\"bigint\"}]}],\"Paths\":[\"s3://jm2vtech/pos/residuos_solidos_ibama/src/compressed/transportador_residuo_solido.parquet\"],\"Recurse\":true}},\"node-1704582644358\":{\"S3GlueParquetTarget\":{\"Compression\":\"uncompressed\",\"Inputs\":[\"node-1704578550767\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://jm2vtech/pos/residuos_solidos_ibama/pipeline/glue/catalog/transportador/\",\"SchemaChangePolicy\":{\"Database\":\"ibama_residuos\",\"EnableUpdateCatalog\":true,\"Table\":\"transportador\",\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"}}},\"node-1704574989215\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://jm2vtech/pos/residuos_solidos_ibama/src/compressed/armazenador_residuo_solido.parquet\"},\"Exclusions\":[],\"Name\":\"Armazenador\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"razsocempresaarmazdest\",\"Type\":\"string\"},{\"Name\":\"estado\",\"Type\":\"string\"},{\"Name\":\"situacao\",\"Type\":\"string\"},{\"Name\":\"razaosocialempgeradoraresiduo\",\"Type\":\"string\"},{\"Name\":\"cnpjarmazenamentodestinacao\",\"Type\":\"string\"},{\"Name\":\"situacaocadastral\",\"Type\":\"string\"},{\"Name\":\"municipio\",\"Type\":\"string\"},{\"Name\":\"razaosocialarmazenador\",\"Type\":\"string\"},{\"Name\":\"unidade\",\"Type\":\"string\"},{\"Name\":\"numcnpjempgeradoraresiduo\",\"Type\":\"string\"},{\"Name\":\"qtdarmazenviadadestfinal\",\"Type\":\"string\"},{\"Name\":\"descresiduo\",\"Type\":\"string\"},{\"Name\":\"cnpjarmazenador\",\"Type\":\"string\"},{\"Name\":\"anodestinacao\",\"Type\":\"bigint\"},{\"Name\":\"tipoarmazenamentodestin\",\"Type\":\"string\"},{\"Name\":\"codresiduo\",\"Type\":\"bigint\"},{\"Name\":\"__index_level_0__\",\"Type\":\"bigint\"}]}],\"Paths\":[\"s3://jm2vtech/pos/residuos_solidos_ibama/src/compressed/armazenador_residuo_solido.parquet\"],\"Recurse\":true}},\"node-1704582700398\":{\"S3GlueParquetTarget\":{\"Compression\":\"uncompressed\",\"Inputs\":[\"node-1704574782898\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://jm2vtech/pos/residuos_solidos_ibama/pipeline/glue/catalog/gerador_unpack/\",\"SchemaChangePolicy\":{\"Database\":\"ibama_residuos\",\"EnableUpdateCatalog\":true,\"Table\":\"gerador_unpack\",\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"}}},\"node-1704582692283\":{\"S3GlueParquetTarget\":{\"Compression\":\"uncompressed\",\"Inputs\":[\"node-1704576533174\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://jm2vtech/pos/residuos_solidos_ibama/pipeline/glue/catalog/gerador/\",\"SchemaChangePolicy\":{\"Database\":\"ibama_residuos\",\"EnableUpdateCatalog\":true,\"Table\":\"gerador\",\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"}}},\"node-1704576951442\":{\"SparkSQL\":{\"Inputs\":[\"node-1704576833854\"],\"Name\":\"SQL Query\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"word\",\"Type\":\"string\"},{\"Name\":\"anoDestinacao\",\"Type\":\"bigint\"},{\"Name\":\"tipo\",\"Type\":\"string\"},{\"Name\":\"razsocempresaarmazdest\",\"Type\":\"double\"},{\"Name\":\"razaosocialempgeradoraresiduo\",\"Type\":\"double\"},{\"Name\":\"razaosocialarmazenador\",\"Type\":\"double\"},{\"Name\":\"descresiduo\",\"Type\":\"double\"}]}],\"SqlAliases\":[{\"Alias\":\"myDataSource\",\"From\":\"node-1704576833854\"}],\"SqlQuery\":\"WITH \\n\\nsplited AS (\\n    SELECT \\n\\n    qtdarmazenviadadestfinal, -- cast(regexp_replace(regexp_replace(qtdarmazenviadadestfinal, '[.]', ''), ',', '.') as double) as qtdarmazenviadadestfinal,\\n    anoDestinacao,\\n    CASE \\n        WHEN unidade=\\\"Litro (L)\\\" THEN 'Líquido'\\n        WHEN unidade=\\\"kilogramas (kg)\\\" THEN 'Sólido'\\n        WHEN unidade=\\\"Unidade (UN)\\\" THEN 'Outro'\\n        ELSE 'Outro'\\n    END AS tipo,\\n    split(lower(regexp_replace(regexp_replace(razsocempresaarmazdest, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as razsocempresaarmazdest,\\n    split(lower(regexp_replace(regexp_replace(razaosocialempgeradoraresiduo, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as razaosocialempgeradoraresiduo,\\n    split(lower(regexp_replace(regexp_replace(razaosocialarmazenador, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as razaosocialarmazenador,\\n    split(lower(regexp_replace(regexp_replace(descresiduo, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as descresiduo\\n\\n    FROM myDataSource\\n),\\n\\nexp_razsocempresaarmazdest AS (\\n    SELECT \\n        word,\\n        anoDestinacao,\\n        tipo,\\n        SUM(COALESCE(CAST(razsocempresaarmazdest AS FLOAT), 0)) AS razsocempresaarmazdest\\n    FROM \\n    (\\n        SELECT \\n            explode(razsocempresaarmazdest) AS word,\\n            anoDestinacao,\\n            tipo,\\n            CASE \\n                WHEN qtdarmazenviadadestfinal IS NULL OR qtdarmazenviadadestfinal = '' THEN '0'\\n                ELSE qtdarmazenviadadestfinal\\n            END AS razsocempresaarmazdest\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anoDestinacao, tipo\\n    ORDER BY word DESC\\n),\\n\\nexp_razaosocialempgeradoraresiduo AS (\\n    SELECT \\n        word,\\n        anoDestinacao,\\n        tipo,\\n        SUM(COALESCE(CAST(razaosocialempgeradoraresiduo AS FLOAT), 0)) AS razaosocialempgeradoraresiduo\\n    FROM \\n    (\\n        SELECT \\n            explode(razaosocialempgeradoraresiduo) AS word,\\n            anoDestinacao,\\n            tipo,\\n            CASE \\n                WHEN qtdarmazenviadadestfinal IS NULL OR qtdarmazenviadadestfinal = '' THEN '0'\\n                ELSE qtdarmazenviadadestfinal\\n            END AS razaosocialempgeradoraresiduo\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anoDestinacao, tipo\\n    ORDER BY word DESC\\n),\\n\\nexp_razaosocialarmazenador AS (\\n    SELECT \\n        word,\\n        anoDestinacao,\\n        tipo,\\n        SUM(COALESCE(CAST(razaosocialarmazenador AS FLOAT), 0)) AS razaosocialarmazenador\\n    FROM \\n    (\\n        SELECT \\n            explode(razaosocialarmazenador) AS word,\\n            anoDestinacao,\\n            tipo,\\n            CASE \\n                WHEN qtdarmazenviadadestfinal IS NULL OR qtdarmazenviadadestfinal = '' THEN '0'\\n                ELSE qtdarmazenviadadestfinal\\n            END AS razaosocialarmazenador\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anoDestinacao, tipo\\n    ORDER BY word DESC\\n),\\n\\nexp_descresiduo AS (\\n    SELECT \\n        word,\\n        anoDestinacao,\\n        tipo,\\n        SUM(COALESCE(CAST(descresiduo AS FLOAT), 0)) AS descresiduo\\n    FROM \\n    (\\n        SELECT \\n            explode(descresiduo) AS word,\\n            anoDestinacao,\\n            tipo,\\n            CASE \\n                WHEN qtdarmazenviadadestfinal IS NULL OR qtdarmazenviadadestfinal = '' THEN '0'\\n                ELSE qtdarmazenviadadestfinal\\n            END AS descresiduo\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anoDestinacao, tipo\\n    ORDER BY word DESC\\n)\\n\\nSELECT \\n    COALESCE(\\n        exp_razsocempresaarmazdest.word, \\n        exp_razaosocialempgeradoraresiduo.word, \\n        exp_razaosocialarmazenador.word, \\n        exp_descresiduo.word\\n        ) AS word,\\n    COALESCE(\\n        exp_razsocempresaarmazdest.anoDestinacao, \\n        exp_razaosocialempgeradoraresiduo.anoDestinacao, \\n        exp_razaosocialarmazenador.anoDestinacao, \\n        exp_descresiduo.anoDestinacao\\n        ) AS anoDestinacao,\\n    COALESCE(\\n        exp_razsocempresaarmazdest.tipo, \\n        exp_razaosocialempgeradoraresiduo.tipo, \\n        exp_razaosocialarmazenador.tipo, \\n        exp_descresiduo.tipo\\n        ) AS tipo,  \\n    COALESCE(razsocempresaarmazdest, 0) AS razsocempresaarmazdest,\\n    COALESCE(razaosocialempgeradoraresiduo, 0) AS razaosocialempgeradoraresiduo,\\n    COALESCE(razaosocialarmazenador, 0) AS razaosocialarmazenador,\\n    COALESCE(descresiduo, 0) AS descresiduo\\n\\nFROM exp_razsocempresaarmazdest \\nFULL OUTER JOIN exp_razaosocialempgeradoraresiduo \\nON exp_razsocempresaarmazdest.word = exp_razaosocialempgeradoraresiduo.word \\nAND exp_razsocempresaarmazdest.anoDestinacao = exp_razaosocialempgeradoraresiduo.anoDestinacao\\nAND exp_razsocempresaarmazdest.tipo = exp_razaosocialempgeradoraresiduo.tipo\\n\\nFULL OUTER JOIN exp_razaosocialarmazenador \\nON COALESCE(exp_razsocempresaarmazdest.word, exp_razaosocialempgeradoraresiduo.word) = exp_razaosocialarmazenador.word\\nAND COALESCE(exp_razsocempresaarmazdest.anoDestinacao, exp_razaosocialempgeradoraresiduo.anoDestinacao) = exp_razaosocialarmazenador.anoDestinacao\\nAND COALESCE(exp_razsocempresaarmazdest.tipo, exp_razaosocialempgeradoraresiduo.tipo) = exp_razaosocialarmazenador.tipo\\n\\nFULL OUTER JOIN exp_descresiduo \\nON COALESCE(exp_razsocempresaarmazdest.word, exp_razaosocialempgeradoraresiduo.word, exp_razaosocialarmazenador.word) = exp_descresiduo.word\\nAND COALESCE(exp_razsocempresaarmazdest.anoDestinacao, exp_razaosocialempgeradoraresiduo.anoDestinacao, exp_razaosocialarmazenador.anoDestinacao) = exp_descresiduo.anoDestinacao\\nAND COALESCE(exp_razsocempresaarmazdest.tipo, exp_razaosocialempgeradoraresiduo.tipo, exp_razaosocialarmazenador.tipo) = exp_descresiduo.tipo\\n\\n;\"}},\"node-1704574745062\":{\"S3ParquetSource\":{\"AdditionalOptions\":{\"EnableSamplePath\":false,\"SamplePath\":\"s3://jm2vtech/pos/residuos_solidos_ibama/src/compressed/gerador_residuo_solido.parquet\"},\"Exclusions\":[],\"Name\":\"Gerador\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"cnpjgerador\",\"Type\":\"string\"},{\"Name\":\"estado\",\"Type\":\"string\"},{\"Name\":\"detalhe\",\"Type\":\"string\"},{\"Name\":\"situacaocadastral\",\"Type\":\"string\"},{\"Name\":\"municipio\",\"Type\":\"string\"},{\"Name\":\"codigodetalhe\",\"Type\":\"bigint\"},{\"Name\":\"anogeracao\",\"Type\":\"bigint\"},{\"Name\":\"codigocategoria\",\"Type\":\"bigint\"},{\"Name\":\"unidade\",\"Type\":\"string\"},{\"Name\":\"classificacaoresiduo\",\"Type\":\"string\"},{\"Name\":\"quantidadegerada\",\"Type\":\"string\"},{\"Name\":\"tiporesiduo\",\"Type\":\"string\"},{\"Name\":\"categoriaatividade\",\"Type\":\"string\"},{\"Name\":\"razaosocialgerador\",\"Type\":\"string\"},{\"Name\":\"codresiduo\",\"Type\":\"bigint\"},{\"Name\":\"__index_level_0__\",\"Type\":\"bigint\"}]}],\"Paths\":[\"s3://jm2vtech/pos/residuos_solidos_ibama/src/compressed/gerador_residuo_solido.parquet\"],\"Recurse\":true}},\"node-1704579002026\":{\"SparkSQL\":{\"Inputs\":[\"node-1704578935239\"],\"Name\":\"SQL Query\",\"OutputSchemas\":[{\"Columns\":[{\"Name\":\"word\",\"Type\":\"string\"},{\"Name\":\"anoDestinacao\",\"Type\":\"bigint\"},{\"Name\":\"tipo\",\"Type\":\"string\"},{\"Name\":\"razaoSocialDestinador\",\"Type\":\"double\"},{\"Name\":\"detalhe\",\"Type\":\"double\"},{\"Name\":\"razaoSocialGeradorResiduo\",\"Type\":\"double\"},{\"Name\":\"descResiduo\",\"Type\":\"double\"}]}],\"SqlAliases\":[{\"Alias\":\"myDataSource\",\"From\":\"node-1704578935239\"}],\"SqlQuery\":\"WITH \\n\\nsplited AS (\\n    SELECT \\n\\n    quantdestinada, -- cast(regexp_replace(regexp_replace(quantdestinada, '[.]', ''), ',', '.') as double) as quantdestinada,\\n    anoDestinacao,\\n    CASE \\n        WHEN unidade=\\\"Litro (L)\\\" THEN 'Líquido'\\n        WHEN unidade=\\\"kilogramas (kg)\\\" THEN 'Sólido'\\n        WHEN unidade=\\\"Unidade (UN)\\\" THEN 'Outro'\\n        ELSE 'Outro'\\n    END AS tipo,\\n    split(lower(regexp_replace(regexp_replace(razaoSocialDestinador, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as razaoSocialDestinador,\\n    split(lower(regexp_replace(regexp_replace(detalhe, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as detalhe,\\n    split(lower(regexp_replace(regexp_replace(razaoSocialGeradorResiduo, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as razaoSocialGeradorResiduo,\\n    split(lower(regexp_replace(regexp_replace(descResiduo, '[^a-zA-Z0-9áéíóúÁÉÍÓÚàèìòùÀÈÌÒÙäëïöüÄËÏÖÜâêîôûÂÊÎÔÛãñõÃÑÕçÇ°º]', ' '), '\\\\\\\\s+', ' ')), ' ') as descResiduo\\n\\n    FROM myDataSource\\n),\\n\\nexp_razaoSocialDestinador AS (\\n    SELECT \\n        word,\\n        anoDestinacao,\\n        tipo,\\n        SUM(COALESCE(CAST(razaoSocialDestinador AS FLOAT), 0)) AS razaoSocialDestinador\\n    FROM \\n    (\\n        SELECT \\n            explode(razaoSocialDestinador) AS word,\\n            anoDestinacao,\\n            tipo,\\n            CASE \\n                WHEN quantdestinada IS NULL OR quantdestinada = '' THEN '0'\\n                ELSE quantdestinada\\n            END AS razaoSocialDestinador\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anoDestinacao, tipo\\n    ORDER BY word DESC\\n),\\n\\nexp_detalhe AS (\\n    SELECT \\n        word,\\n        anoDestinacao,\\n        tipo,\\n        SUM(COALESCE(CAST(detalhe AS FLOAT), 0)) AS detalhe\\n    FROM \\n    (\\n        SELECT \\n            explode(detalhe) AS word,\\n            anoDestinacao,\\n            tipo,\\n            CASE \\n                WHEN quantdestinada IS NULL OR quantdestinada = '' THEN '0'\\n                ELSE quantdestinada\\n            END AS detalhe\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anoDestinacao, tipo\\n    ORDER BY word DESC\\n),\\n\\nexp_razaoSocialGeradorResiduo AS (\\n    SELECT \\n        word,\\n        anoDestinacao,\\n        tipo,\\n        SUM(COALESCE(CAST(razaoSocialGeradorResiduo AS FLOAT), 0)) AS razaoSocialGeradorResiduo\\n    FROM \\n    (\\n        SELECT \\n            explode(razaoSocialGeradorResiduo) AS word,\\n            anoDestinacao,\\n            tipo,\\n            CASE \\n                WHEN quantdestinada IS NULL OR quantdestinada = '' THEN '0'\\n                ELSE quantdestinada\\n            END AS razaoSocialGeradorResiduo\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anoDestinacao, tipo\\n    ORDER BY word DESC\\n),\\n\\nexp_descResiduo AS (\\n    SELECT \\n        word,\\n        anoDestinacao,\\n        tipo,\\n        SUM(COALESCE(CAST(descResiduo AS FLOAT), 0)) AS descResiduo\\n    FROM \\n    (\\n        SELECT \\n            explode(descResiduo) AS word,\\n            anoDestinacao,\\n            tipo,\\n            CASE \\n                WHEN quantdestinada IS NULL OR quantdestinada = '' THEN '0'\\n                ELSE quantdestinada\\n            END AS descResiduo\\n        FROM splited\\n    ) AS exploded_words\\n    WHERE NOT (word RLIKE '^[0-9]+([,.][0-9]+)?$') AND word != ''\\n    GROUP BY word, anoDestinacao, tipo\\n    ORDER BY word DESC\\n)\\n\\nSELECT \\n    COALESCE(\\n        exp_razaoSocialDestinador.word, \\n        exp_detalhe.word, \\n        exp_razaoSocialGeradorResiduo.word, \\n        exp_descResiduo.word\\n        ) AS word,\\n    COALESCE(\\n        exp_razaoSocialDestinador.anoDestinacao, \\n        exp_detalhe.anoDestinacao, \\n        exp_razaoSocialGeradorResiduo.anoDestinacao, \\n        exp_descResiduo.anoDestinacao\\n        ) AS anoDestinacao,\\n    COALESCE(\\n        exp_razaoSocialDestinador.tipo, \\n        exp_detalhe.tipo, \\n        exp_razaoSocialGeradorResiduo.tipo, \\n        exp_descResiduo.tipo\\n        ) AS tipo,  \\n    COALESCE(razaoSocialDestinador, 0) AS razaoSocialDestinador,\\n    COALESCE(detalhe, 0) AS detalhe,\\n    COALESCE(razaoSocialGeradorResiduo, 0) AS razaoSocialGeradorResiduo,\\n    COALESCE(descResiduo, 0) AS descResiduo\\n\\nFROM exp_razaoSocialDestinador \\nFULL OUTER JOIN exp_detalhe \\nON exp_razaoSocialDestinador.word = exp_detalhe.word \\nAND exp_razaoSocialDestinador.anoDestinacao = exp_detalhe.anoDestinacao\\nAND exp_razaoSocialDestinador.tipo = exp_detalhe.tipo\\n\\nFULL OUTER JOIN exp_razaoSocialGeradorResiduo \\nON COALESCE(exp_razaoSocialDestinador.word, exp_detalhe.word) = exp_razaoSocialGeradorResiduo.word\\nAND COALESCE(exp_razaoSocialDestinador.anoDestinacao, exp_detalhe.anoDestinacao) = exp_razaoSocialGeradorResiduo.anoDestinacao\\nAND COALESCE(exp_razaoSocialDestinador.tipo, exp_detalhe.tipo) = exp_razaoSocialGeradorResiduo.tipo\\n\\nFULL OUTER JOIN exp_descResiduo \\nON COALESCE(exp_razaoSocialDestinador.word, exp_detalhe.word, exp_razaoSocialGeradorResiduo.word) = exp_descResiduo.word\\nAND COALESCE(exp_razaoSocialDestinador.anoDestinacao, exp_detalhe.anoDestinacao, exp_razaoSocialGeradorResiduo.anoDestinacao) = exp_descResiduo.anoDestinacao\\nAND COALESCE(exp_razaoSocialDestinador.tipo, exp_detalhe.tipo, exp_razaoSocialGeradorResiduo.tipo) = exp_descResiduo.tipo\\n\\n;\"}},\"node-1704582534247\":{\"S3GlueParquetTarget\":{\"Compression\":\"uncompressed\",\"Inputs\":[\"node-1704576833854\"],\"Name\":\"Amazon S3\",\"PartitionKeys\":[],\"Path\":\"s3://jm2vtech/pos/residuos_solidos_ibama/pipeline/glue/catalog/armazenador/\",\"SchemaChangePolicy\":{\"Database\":\"ibama_residuos\",\"EnableUpdateCatalog\":true,\"Table\":\"armazenador\",\"UpdateBehavior\":\"UPDATE_IN_DATABASE\"}}}}",
  "sourceControlDetails" : {
    "provider" : "GITHUB",
    "repository" : "IBAMA_residues",
    "branch" : "main",
    "folder" : "AWS_GLUE"
  }
}